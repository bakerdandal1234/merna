// ูููุฉ ูุฌุฏููุฉ (Cron Job) ูููุญุต ุงูุฏูุฑู ุนู ุงูุฌูู ุงููุณุชุญูุฉ ูููุฑุงุฌุนุฉ
const cron = require('node-cron');
const { checkDueSentencesAndNotify } = require('../services/notificationService');

// ๐ ุจุฏุก ุฌุฏููุฉ ุงูููุงู ุงูุฏูุฑูุฉ
const startCronJobs = () => {
  console.log('๐ ุจุฏุก ุชุดุบูู ุงูููุงู ุงููุฌุฏููุฉ...');

  // ========================================
  // ุงููููุฉ ุงูุฃููู: ูุญุต ูู ุณุงุนุฉ
  // ========================================
  // ุชุนูู ูู ุณุงุนุฉ ูู ุงูุฏูููุฉ 0
  // ูุซุงู: 1:00 AM, 2:00 AM, 3:00 AM, ุฅูุฎ.
  cron.schedule('0 * * * *', async () => {
    console.log('\nโฐ [ุงููููุฉ ุงููุฌุฏููุฉ] ูุญุต ุงูุฌูู ุงููุณุชุญูุฉ - ูู ุณุงุนุฉ');
    await checkDueSentencesAndNotify();
  });

  // ========================================
  // ุงููููุฉ ุงูุซุงููุฉ (ุงุฎุชูุงุฑูุฉ): ูุญุต ูู 3 ุณุงุนุงุช
  // ========================================
  // ุฅุฐุง ุฃุฑุฏุช ุงููุญุต ูู 3 ุณุงุนุงุช ุจุฏูุงู ูู ูู ุณุงุนุฉุ ุงุณุชุฎุฏู ูุฐุง ุงูุณุทุฑ ุจุฏูุงู ูู ุงูุณุงุจู:
  // cron.schedule('0 */3 * * *', async () => {
  //   console.log('\nโฐ [ุงููููุฉ ุงููุฌุฏููุฉ] ูุญุต ุงูุฌูู ุงููุณุชุญูุฉ - ูู 3 ุณุงุนุงุช');
  //   await checkDueSentencesAndNotify();
  // });

  // ========================================
  // ุฃูุซูุฉ ุฃุฎุฑู ูุฌุฏููุฉ ุงูููุงู:
  // ========================================
  
  // ูู 30 ุฏูููุฉ:
  // cron.schedule('*/30 * * * *', async () => { ... });
  
  // ูู 6 ุณุงุนุงุช:
  // cron.schedule('0 */6 * * *', async () => { ... });
  
  // ูู ููู ูู ุงูุณุงุนุฉ 9 ุตุจุงุญุงู:
  // cron.schedule('0 9 * * *', async () => { ... });
  
  // ูู ููู ูู ุงูุณุงุนุฉ 9 ุตุจุงุญุงู ู 6 ูุณุงุกู:
  // cron.schedule('0 9,18 * * *', async () => { ... });

  console.log('โ ุชู ุชูุนูู ุงูููุงู ุงููุฌุฏููุฉ ุจูุฌุงุญ!');
  console.log('๐ ุงููููุฉ: ูุญุต ุงูุฌูู ุงููุณุชุญูุฉ ูู ุณุงุนุฉ (0 * * * *)');
  console.log('๐ ุณูุชู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุชููุงุฆูุงู ูููุณุชุฎุฏููู ุงูุฐูู ูุฏููู ุฌูู ูููุฑุงุฌุนุฉ\n');
};

module.exports = { startCronJobs };

/* 
===============================================
ุดุฑุญ ุตูุบุฉ Cron
===============================================

ุงูุตูุบุฉ ุงูุนุงูุฉ: minute hour day month weekday

ุญูุซ:
- minute: ุงูุฏูููุฉ (0-59)
- hour: ุงูุณุงุนุฉ (0-23)
- day: ููู ุงูุดูุฑ (1-31)
- month: ุงูุดูุฑ (1-12)
- weekday: ููู ุงูุฃุณุจูุน (0-7ุ ุญูุซ 0 ู 7 = ุงูุฃุญุฏ)

ุฃูุซูุฉ ุนูููุฉ:
- '0 * * * *'      ูู ุณุงุนุฉ ูู ุงูุฏูููุฉ 0
- '* /30 * * * *'  ูู 30 ุฏูููุฉ (ุงุญุฐู ุงููุณุงูุฉ)
- '0 * /3 * * *'   ูู 3 ุณุงุนุงุช (ุงุญุฐู ุงููุณุงูุฉ)
- '0 9 * * *'      ูู ููู ุงูุณุงุนุฉ 9 ุตุจุงุญุงู
- '0 9,18 * * *'   ูู ููู ุงูุณุงุนุฉ 9 ุตุจุงุญุงู ู 6 ูุณุงุกู
- '0 0 * * 0'      ูู ููู ุฃุญุฏ ููุชุตู ุงูููู

ููุงุญุธุฉ: ุชู ุฅุถุงูุฉ ูุณุงูุงุช ูู ุจุนุถ ุงูุฃูุซูุฉ ูุชุฌูุจ ูุดุงูู ุงูุชูุณูุฑ
===============================================
*/
