# ๐ ุดุฑุญ ูุธุงู ุงููุฑุงุฌุนุฉ ุงููุดุชุฑูุฉ ููุฌูู

## ๐ฏ ูุง ุชู ุชุบููุฑูุ

ุชู ุชุนุฏูู ุงููุธุงู ููุณูุญ **ูุฌููุน ุงููุณุชุฎุฏููู** ุจูุฑุงุฌุนุฉ **ุฌููุน ุงูุฌูู** ุงููุฎุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุจุบุถ ุงููุธุฑ ุนู ูู ุฃุถุงููุง.

---

## โ ุงูุตูุงุญูุงุช ุงูุฌุฏูุฏุฉ

### 1๏ธโฃ **ุงููุฑุงุฌุนุฉ (Review)** - ูุชุงุญุฉ ููุฌููุน
- ุฃู ูุณุชุฎุฏู ููููู ูุฑุงุฌุนุฉ ุฃู ุฌููุฉ
- ูุธุงู SM-2 ูุนูู ุนูู ุฌููุน ุงูุฌูู
- ูุง ููุฌุฏ ูููุฏ ุนูู ูู ุฃุถุงู ุงูุฌููุฉ

### 2๏ธโฃ **ุงูุฅุถุงูุฉ (Create)** - ููุง ูู
- ูู ูุณุชุฎุฏู ูุถูู ุฌูู ุฎุงุตุฉ ุจู
- ุงูุฌููุฉ ุชูุญูุธ ูุน `userId` ุงูุฎุงุต ุจูู ุฃุถุงููุง

### 3๏ธโฃ **ุงูุชุนุฏูู (Update)** - ูููุงูู ููุท
- ููุท ุตุงุญุจ ุงูุฌููุฉ ููููู ุชุนุฏูููุง
- `checkSentenceOwnership` middleware ูุง ูุฒุงู ูุนูู

### 4๏ธโฃ **ุงูุญุฐู (Delete)** - ูููุงูู ููุท
- ููุท ุตุงุญุจ ุงูุฌููุฉ ููููู ุญุฐููุง
- `checkSentenceOwnership` middleware ูุง ูุฒุงู ูุนูู

---

## ๐ง ุงูุชุบููุฑุงุช ุงูุชูููุฉ ูู Backend

### 1. Route ุงููุฑุงุฌุนุฉ `/api/sentences/:id/review`
```javascript
// ูุจู ุงูุชุนุฏูู โ
app.post('/api/sentences/:id/review', protect, checkSentenceOwnership(Sentence), async (req, res) => {
  const sentence = req.sentence; // ูู middleware
  // ...
});

// ุจุนุฏ ุงูุชุนุฏูู โ
app.post('/api/sentences/:id/review', protect, async (req, res) => {
  // ุงูุจุญุซ ุนู ุงูุฌููุฉ ุจุฏูู ุงูุชุญูู ูู ุงูููููุฉ
  const sentence = await Sentence.findById(req.params.id);
  // ...
});
```

### 2. Route ุงูุฌูู ุงููุณุชุญูุฉ `/api/sentences/due`
```javascript
// ูุจู ุงูุชุนุฏูู โ
const dueSentences = await Sentence.find({
  userId: req.user._id,
  nextReview: { $lte: now }
});

// ุจุนุฏ ุงูุชุนุฏูู โ
const dueSentences = await Sentence.find({
  nextReview: { $lte: now }
});
```

### 3. Route ุงูุฅุญุตุงุฆูุงุช `/api/stats`
```javascript
// ูุจู ุงูุชุนุฏูู โ
const total = await Sentence.countDocuments({ userId: req.user._id });
const levelCounts = await Sentence.aggregate([
  { $match: { userId: req.user._id } },
  // ...
]);

// ุจุนุฏ ุงูุชุนุฏูู โ
const total = await Sentence.countDocuments({});
const levelCounts = await Sentence.aggregate([
  { $group: { /* ... */ } }
]);
```

### 4. Route ุฅุนุงุฏุฉ ุงูุชุนููู `/api/sentences/reset`
```javascript
// ูุจู ุงูุชุนุฏูู โ
await Sentence.updateMany(
  { userId: req.user._id },
  { $set: { /* ... */ } }
);

// ุจุนุฏ ุงูุชุนุฏูู โ
const result = await Sentence.updateMany(
  {},
  { $set: { /* ... */ } }
);
```

---

## ๐ ูุง ูู ูุชู ุชุบููุฑูุ

### Routes ุจููุช ููุง ูู:
- โ `GET /api/sentences` - ุฌูุจ ุฌููุน ุงูุฌูู (ูุงู ูุนูู ุจุงููุนู)
- โ `GET /api/sentences/my-sentences` - ุฌูุจ ุฌูู ุงููุณุชุฎุฏู ููุท
- โ `POST /api/sentences` - ุฅุถุงูุฉ ุฌููุฉ (ูุง ุชุฒุงู ุชูุญูุธ ูุน userId)
- โ `PUT /api/sentences/:id` - ุชุนุฏูู ุฌููุฉ (ูุง ูุฒุงู ูููุงูู ููุท)
- โ `DELETE /api/sentences/:id` - ุญุฐู ุฌููุฉ (ูุง ูุฒุงู ูููุงูู ููุท)

### Middleware ุจููุช ููุง ูู:
- โ `protect` - ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู (ูุนูู ุนูู ุฌููุน Routes)
- โ `checkSentenceOwnership` - ุงูุชุญูู ูู ุงูููููุฉ (ูุนูู ุนูู Update/Delete ููุท)

---

## ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ุงููููุฐุฌ ุงูุฌุฏูุฏ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         ุฌููุน ุงูุฌูู ูู ุงููุธุงู           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โโโ> ุงููุฑุงุฌุนุฉ โ (ุฌููุน ุงููุณุชุฎุฏููู)
           โโโ> ุงููุฑุงุกุฉ โ (ุฌููุน ุงููุณุชุฎุฏููู)
           โโโ> ุงูุฅุญุตุงุฆูุงุช โ (ูุฌููุน ุงูุฌูู)
           โ
           โโโ> ููุฌูู ุงูุชู ุฃุถุงููุง ุงููุณุชุฎุฏู ููุท:
                โโโ> ุงูุชุนุฏูู โ
                โโโ> ุงูุญุฐู โ
```

---

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุงููุฑุงุฌุนุฉ
```javascript
// ุงููุณุชุฎุฏู A ูุฑุงุฌุน ุฌููุฉ ุฃุถุงููุง ุงููุณุชุฎุฏู B
POST /api/sentences/abc123/review
{
  "quality": 3  // ุฅุฌุงุจุฉ ุตุญูุญุฉ
}

// ุงููุชูุฌุฉ: โ ูุฌุญุช ุงููุฑุงุฌุนุฉ
// ุงูุฌููุฉ ุชู ุชุญุฏูุซ interval ู reviewLevel ุงูุฎุงุต ุจูุง
```

### ูุซุงู 2: ุงูุชุนุฏูู
```javascript
// ุงููุณุชุฎุฏู A ูุญุงูู ุชุนุฏูู ุฌููุฉ ุฃุถุงููุง ุงููุณุชุฎุฏู B
PUT /api/sentences/abc123
{
  "german": "Hallo Welt",
  "arabic": "ูุฑุญุจุง ุจุงูุนุงูู"
}

// ุงููุชูุฌุฉ: โ ุฎุทุฃ 403
// {
//   "success": false,
//   "message": "๐ซ ุบูุฑ ูุณููุญ! ููููู ููุท ุชุนุฏูู/ุญุฐู ุงูุฌูู ุงูุชู ุฃุถูุชูุง ุฃูุช"
// }
```

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงููุฑุงุฌุนุฉ ููุฌูู ุงูุนุงูุฉ
```bash
# ุชุณุฌูู ุฏุฎูู ููุณุชุฎุฏู A
POST /api/auth/login
{
  "email": "userA@example.com",
  "password": "password"
}

# ุฌูุจ ุฌููุน ุงูุฌูู
GET /api/sentences

# ูุฑุงุฌุนุฉ ุฃู ุฌููุฉ (ุญุชู ูู ุฃุถุงููุง ูุณุชุฎุฏู ุขุฎุฑ)
POST /api/sentences/:id/review
{
  "quality": 3
}
```

### 2. ุงุฎุชุจุงุฑ ุงูุฅุญุตุงุฆูุงุช ุงูุดุงููุฉ
```bash
# ุฌูุจ ุฅุญุตุงุฆูุงุช ุฌููุน ุงูุฌูู
GET /api/stats

# ุงูุงุณุชุฌุงุจุฉ ุชุดูู:
# - total: ุนุฏุฏ ุฌููุน ุงูุฌูู
# - due: ุนุฏุฏ ุงูุฌูู ุงููุณุชุญูุฉ (ูู ุฌููุน ุงููุณุชุฎุฏููู)
# - ุงููุณุชููุงุช: new, learning, hard, good, excellent, mastered
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุญูู `userId` ูุง ูุฒุงู ููุฌูุฏ** ูู Schema - ููุณุชุฎุฏู ูุชุญุฏูุฏ ุตุงุญุจ ุงูุฌููุฉ ููุชุนุฏูู/ุงูุญุฐู
2. **ุญูู `isOwner`** ููุถุงู ุชููุงุฆููุง ูู Response ููุณุงุนุฏุฉ Frontend ูู ุชุญุฏูุฏ ุงูุตูุงุญูุงุช
3. **ูุธุงู SM-2** ูุนูู ุจุดูู ูุณุชูู ุนู userId
4. **ุงูุฃูุงู** ูุง ูุฒุงู ูุญููุธูุง - ุงูุชุนุฏูู ูุงูุญุฐู ูููุงูู ููุท

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

ุฅุฐุง ุฃุฑุฏุช ุชุญุณููุงุช ุฅุถุงููุฉ:

1. **ุฅุถุงูุฉ ููุชุฑ ูู Frontend** ูุนุฑุถ "ุฌููู ููุท" ุฃู "ุฌููุน ุงูุฌูู"
2. **ุฅุถุงูุฉ ูุธุงู Favorites ูุดุชุฑู** ููุฌูู ุงูููุถูุฉ
3. **ุฅุถุงูุฉ Comments** ุนูู ุงูุฌูู ููุชุนุงูู ุจูู ุงููุณุชุฎุฏููู
4. **ุฅุถุงูุฉ Voting System** ูุชูููู ุฌูุฏุฉ ุงูุฌูู

---

## โจ ุงูุฎูุงุตุฉ

ุงูุชุนุฏููุงุช ุจุณูุทุฉ ููู ูุนุงูุฉ:
- โ **ุฅุฒุงูุฉ** `checkSentenceOwnership` ูู route ุงููุฑุงุฌุนุฉ
- โ **ุฅุฒุงูุฉ** `{ userId: req.user._id }` ูู queries ุงูุฌูู ุงููุณุชุญูุฉ ูุงูุฅุญุตุงุฆูุงุช
- โ **ุงูุญูุงุธ** ุนูู ุงูุฃูุงู ูู ุงูุชุนุฏูู ูุงูุญุฐู
- โ **ุงูุณูุงุญ** ููุฌููุน ุจุงููุฑุงุฌุนุฉ ูุงูุชุนูู ูู ุฌููุน ุงูุฌูู
